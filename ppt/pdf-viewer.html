<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Secure PDF Viewer</title>
    <meta name="robots" content="noindex, nofollow" />
    <style>
      * {
        box-sizing: border-box;
      }

      html,
      body {
        width: 100%;
        height: 100%;
        margin: 0;
        overflow: hidden;
        background: #eef3ff;
        font-family: Arial, sans-serif;
        user-select: none;
        -webkit-user-select: none;
        -webkit-touch-callout: none;
        touch-action: pan-y;
      }

      .shell {
        width: 100%;
        height: 100dvh;
        padding: 10px 12px 12px clamp(12px, 2.4vw, 28px);
      }

      .viewer-card {
        width: 100%;
        height: 100%;
        overflow: hidden;
        border-radius: 14px;
        border: 1px solid #d7e2ff;
        background: #ffffff;
        box-shadow: 0 10px 30px rgba(24, 62, 133, 0.12);
      }

      .topbar {
        height: 44px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 12px;
        color: #17325f;
        background: #f8fbff;
        border-bottom: 1px solid #dce7ff;
      }

      .title {
        font-size: 14px;
        font-weight: 600;
        letter-spacing: 0.2px;
      }

      .note {
        font-size: 12px;
        opacity: 0.9;
        color: #3f5f95;
      }

      .viewer {
        width: 100%;
        height: calc(100dvh - 44px);
        border: 0;
        pointer-events: auto;
        display: block;
        overflow: auto;
        -webkit-overflow-scrolling: touch;
      }

      .blocked {
        height: calc(100dvh - 44px);
        display: grid;
        place-items: center;
        color: #fff;
        padding: 20px;
        text-align: center;
      }

      @media (max-width: 768px) {
        html,
        body {
          overflow: auto;
          height: auto;
          min-height: 100dvh;
        }

        .shell {
          padding: 0;
          min-height: 100dvh;
        }

        .viewer-card {
          border-radius: 0;
          border: 0;
          box-shadow: none;
          min-height: 100dvh;
        }

        .topbar {
          position: sticky;
          top: 0;
          z-index: 2;
        }

        .viewer,
        .blocked {
          height: calc(100dvh - 44px);
        }
      }

      @media print {
        html,
        body {
          display: none !important;
        }
      }

      body.print-denied * {
        visibility: hidden !important;
      }
    </style>
  </head>
  <body>
    <div class="shell">
      <div class="viewer-card">
        <div class="topbar">
          <div class="title">Protected PDF Preview</div>
          <div class="note">Download / Print disabled (best-effort)</div>
        </div>

        <iframe
          id="pdfFrame"
          class="viewer"
          referrerpolicy="no-referrer"
          sandbox=""
        ></iframe>
        <div id="blocked" class="blocked" hidden>Invalid PDF URL.</div>
      </div>
    </div>

    <script>
      (function () {
        const allowedPrefix = "https://everythingeasy.in/ppt/";
        const urlParams = new URLSearchParams(window.location.search);
        const src = urlParams.get("src") || "";
        const frame = document.getElementById("pdfFrame");
        const blocked = document.getElementById("blocked");
        const isTouchDevice =
          "ontouchstart" in window || navigator.maxTouchPoints > 0;

        const isAllowed = src.startsWith(allowedPrefix) && src.endsWith(".pdf");

        if (!isAllowed) {
          frame.hidden = true;
          blocked.hidden = false;
        } else {
          frame.src = `${src}#toolbar=0&navpanes=0&scrollbar=0&view=FitV&zoom=page-fit`;
        }

        const blockedKeyCombo = (event) => {
          const key = event.key.toLowerCase();
          const ctrlOrCmd = event.ctrlKey || event.metaKey;

          if (
            key === "f12" ||
            (ctrlOrCmd && event.shiftKey && ["i", "j", "c"].includes(key)) ||
            (ctrlOrCmd && ["u", "s", "p"].includes(key))
          ) {
            event.preventDefault();
            event.stopPropagation();
            event.stopImmediatePropagation();
            return false;
          }

          return true;
        };

        ["keydown", "keypress", "keyup"].forEach((eventName) => {
          window.addEventListener(eventName, blockedKeyCombo, true);
          document.addEventListener(eventName, blockedKeyCombo, true);
        });
        document.addEventListener(
          "contextmenu",
          (event) => {
            event.preventDefault();
          },
          true,
        );

        document.addEventListener(
          "dragstart",
          (event) => {
            event.preventDefault();
          },
          true,
        );

        const denyPrint = () => {
          document.body.classList.add("print-denied");
          setTimeout(() => {
            document.body.classList.remove("print-denied");
          }, 700);
        };

        window.addEventListener("beforeprint", denyPrint);

        const printMediaQuery = window.matchMedia("print");
        if (printMediaQuery && printMediaQuery.addEventListener) {
          printMediaQuery.addEventListener("change", (event) => {
            if (event.matches) denyPrint();
          });
        }

        if (!isTouchDevice) {
          setInterval(() => {
            const widthDiff = window.outerWidth - window.innerWidth;
            const heightDiff = window.outerHeight - window.innerHeight;
            const devToolsLikelyOpen = widthDiff > 160 || heightDiff > 160;

            if (devToolsLikelyOpen) {
              document.body.innerHTML = "";
            }
          }, 1000);
        }
      })();
    </script>
  </body>
</html>
